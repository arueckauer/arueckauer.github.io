<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Andi Rückauer ">
<meta name="description"
    content="This article is part of my #100DaysOfCode and #100DaysOfBlogging challenge. R1D8
This is part one of a series of articles about the PHP Version Switcher.
 Part Two: Php Version Switcher: PowerShell Naming Convention Part Three: Php Version Switcher: The Structure Part Four: Php Version Switcher: The Function   Most of our costumers provide Windows Servers for the PHP applications we implement and maintain for them. Although it has become much easier to get a PHP running under Windows than ten years ago, it&amp;rsquo;s still not the choice environment for a typical PHP web application." />
<meta name="keywords" content="andi, rückauer, blog, software, development" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://arueckauer.github.io/posts/2019/05/php-version-switcher-powershell-module/" />


<title>
    
    Php Version Switcher: PowerShell Module :: Andi Rückauer  — Thoughts container
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://arueckauer.github.io/main.min.cabb110faab88d3545467f36114f6bf3ac23f81434679cf37338752570b2eda1.css">



<link rel="apple-touch-icon" sizes="180x180" href="https://arueckauer.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://arueckauer.github.io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://arueckauer.github.io/favicon-16x16.png">
<link rel="manifest" href="https://arueckauer.github.io/site.webmanifest">
<link rel="mask-icon" href="https://arueckauer.github.io/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="https://arueckauer.github.io/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Php Version Switcher: PowerShell Module">
<meta itemprop="description" content="This article is part of my #100DaysOfCode and #100DaysOfBlogging challenge. R1D8
This is part one of a series of articles about the PHP Version Switcher.
 Part Two: Php Version Switcher: PowerShell Naming Convention Part Three: Php Version Switcher: The Structure Part Four: Php Version Switcher: The Function   Most of our costumers provide Windows Servers for the PHP applications we implement and maintain for them. Although it has become much easier to get a PHP running under Windows than ten years ago, it&rsquo;s still not the choice environment for a typical PHP web application."><meta itemprop="datePublished" content="2019-05-28T20:36:42+02:00" />
<meta itemprop="dateModified" content="2019-05-31T23:41:32+02:00" />
<meta itemprop="wordCount" content="1058"><meta itemprop="image" content="https://arueckauer.github.io/"/>
<meta itemprop="keywords" content="100-days-of-code,php,powershell," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://arueckauer.github.io/"/>

<meta name="twitter:title" content="Php Version Switcher: PowerShell Module"/>
<meta name="twitter:description" content="This article is part of my #100DaysOfCode and #100DaysOfBlogging challenge. R1D8
This is part one of a series of articles about the PHP Version Switcher.
 Part Two: Php Version Switcher: PowerShell Naming Convention Part Three: Php Version Switcher: The Structure Part Four: Php Version Switcher: The Function   Most of our costumers provide Windows Servers for the PHP applications we implement and maintain for them. Although it has become much easier to get a PHP running under Windows than ten years ago, it&rsquo;s still not the choice environment for a typical PHP web application."/>




<meta property="article:published_time" content="2019-05-28 20:36:42 &#43;0200 CEST" />







    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://arueckauer.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">Thoughts Container</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://arueckauer.github.io/about">About</a></li><li><a href="https://arueckauer.github.io/posts">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>5 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title"><a href="https://arueckauer.github.io/posts/2019/05/php-version-switcher-powershell-module/">Php Version Switcher: PowerShell Module</a></h1>

            

            <div class="post-content">
                <p><em>This article is part of my <a href="https://arueckauer.github.io/tags/100-days-of-code/">#100DaysOfCode</a> and #100DaysOfBlogging challenge. R1D8</em></p>
<p>This is part one of a series of articles about the <a href="https://github.com/arueckauer/pvs">PHP Version Switcher</a>.</p>
<ul>
<li>Part Two: <a href="https://arueckauer.github.io/posts/2019/05/php-version-switcher-powershell-naming-convention/">Php Version Switcher: PowerShell Naming Convention</a></li>
<li>Part Three: <a href="https://arueckauer.github.io/posts/2019/05/php-version-switcher-the-structure/">Php Version Switcher: The Structure</a></li>
<li>Part Four: <a href="https://arueckauer.github.io/posts/2019/05/php-version-switcher-the-function/">Php Version Switcher: The Function</a></li>
</ul>
<hr>
<p>Most of our costumers provide Windows Servers for the PHP applications we implement and maintain for them. Although it has become much easier to get a PHP running under Windows than ten years ago, it&rsquo;s still not the choice environment for a typical PHP web application.</p>
<p>Last year a co-worker and I discussed the possibility of providing each project with a <a href="https://www.vagrantup.com/">Vagrant</a> box for development purposes that runs a comparable setup as the production environment. Until then each developer had his own WAMP setup and most likely non looked like any other development or production environment. I had a Linux machine in mind. Making the transition from Windows to Linux and providing the necessary infrastructure is not done in just one day.</p>
<p>In the discussion I addressed the laborious manual process of switching in-between PHP versions. Then it dawned on me that by using symlinks, it might be possible to easily switch to another PHP version. Later on, I started working on the setup and wrote a batch file - and surely it worked! 🙌😊</p>
<p>Lately I have become fond of PowerShell. Today I want to start rewriting that batch file of the PHP version switcher into a PowerShell module. For now, I am starting with a PowerShell Module. Tomorrow I continue with the rewrite. An additional feature is a PHP version manager, which would allow the installing and removing PHP versions. I&rsquo;ll see how far that can be automated on another day.</p>
<h2 id="creating-a-powershell-module">Creating a PowerShell Module</h2>
<p>The functionality of the PHP version switcher will be placed in a Cmdlet. The plan is to make the Cmdlet available through a Module and possibly publish it on <a href="https://www.powershellgallery.com/packages/">PowerShell Gallery</a> and/or <a href="https://chocolatey.org/packages">chocolatey</a>.</p>
<p>To create my first PowerShell module, I follow the article <a href="https://docs.microsoft.com/en-us/powershell/developer/module/how-to-write-a-powershell-script-module">How to Write a PowerShell Script Module</a>. Right now I only need steps 1 and 2. If you want to know more about the steps or further steps not mentioned here, head over to the referenced article.</p>
<h3 id="1-save-powershell-script-with-a-psm1-extension">1. Save PowerShell script with a .psm1 extension</h3>
<p>Since I don&rsquo;t have an existing PowerShell script and can&rsquo;t just dump in the batch file, I am starting with a fresh function. For now, I just want to declare my function and parameters. Then give the user some output. The real functionality will be added later.</p>
<pre><code class="language-powershell">function Php-VersionSwitcher
{
    Param (
        [Parameter(Mandatory=$true, ValueFromPipeline=$true)] [Alias(&quot;v&quot;)] [String]$version
    )

    Write-Host &quot;PHP Version Switcher 1.0.0 by Andi Rückauer&quot; -ForegroundColor Blue
    Write-Host &quot;&quot;
    Write-Host &quot;Switching to version: $version...&quot; -ForegroundColor DarkCyan
    Write-Host &quot;&quot;
}
</code></pre>
<p>I save this to the file <code>Php-VersionSwitcher.psm1</code>.</p>
<h3 id="2-export-modulemember">2. Export-ModuleMember</h3>
<p>The function would be exposed by default. It is recommended however, to explicitly declare functions one wants to expose. Here it goes.</p>
<pre><code class="language-powershell">Export-ModuleMember -Function Php-VersionSwitcher
</code></pre>
<h3 id="create-powershell-module-manifest">Create PowerShell Module Manifest</h3>
<p>Next, I follow the instructions found in <a href="https://docs.microsoft.com/en-us/powershell/developer/module/how-to-write-a-powershell-module-manifest">How to Write a PowerShell Module Manifest</a>. I&rsquo;ll go with option 1.b. and create the Manifest with the <a href="https://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest">New-ModuleManifest</a> cmdlet.</p>
<pre><code class="language-powershell">New-ModuleManifest .\Php-VersionSwitcher.psd1 -ModuleVersion 1.0 -Author &quot;Andi Rückauer&quot;
</code></pre>
<p>I open the <code>Php-VersionSwitcher.psd1</code> and update necessary and removing unnecessary information. This is what it looks like now.</p>
<pre><code class="language-powershell">@{

    # Die diesem Manifest zugeordnete Skript- oder Binärmoduldatei.
    RootModule          = 'Php-VersionSwitcher.psm1'

    # Die Versionsnummer dieses Moduls
    ModuleVersion       = '1.0.0'

    # ID zur eindeutigen Kennzeichnung dieses Moduls
    GUID                = '69305790-69cd-4ffe-af1c-f7ec6e486d13'

    # Autor dieses Moduls
    Author              = 'Andi Rückauer'

    # Unternehmen oder Hersteller dieses Moduls
    CompanyName         = 'Unbekannt'

    # Urheberrechtserklärung für dieses Modul
    Copyright           = '(c) 2019 Andi Rückauer. Alle Rechte vorbehalten.'

    # Beschreibung der von diesem Modul bereitgestellten Funktionen
    Description         = 'Switching PHP versions on Windows made easy'

    # Die für dieses Modul mindestens erforderliche Version des Windows PowerShell-Moduls
    PowerShellVersion   = '5.0'

    # Aus diesem Modul zu exportierende Funktionen. Um optimale Leistung zu erzielen, verwenden Sie keine Platzhalter und löschen den Eintrag nicht. Verwenden Sie ein leeres Array, wenn keine zu exportierenden Funktionen vorhanden sind.
    FunctionsToExport   = @('Php-VersionSwitcher')

    # Aus diesem Modul zu exportierende Cmdlets. Um optimale Leistung zu erzielen, verwenden Sie keine Platzhalter und löschen den Eintrag nicht. Verwenden Sie ein leeres Array, wenn keine zu exportierenden Cmdlets vorhanden sind.
    CmdletsToExport     = @()

    # Die aus diesem Modul zu exportierenden Variablen
    VariablesToExport   = '*'

    # Aus diesem Modul zu exportierende Aliase. Um optimale Leistung zu erzielen, verwenden Sie keine Platzhalter und löschen den Eintrag nicht. Verwenden Sie ein leeres Array, wenn keine zu exportierenden Aliase vorhanden sind.
    AliasesToExport     = @()

    # Die privaten Daten, die an das in &quot;RootModule/ModuleToProcess&quot; angegebene Modul übergeben werden sollen. Diese können auch eine PSData-Hashtabelle mit zusätzlichen von PowerShell verwendeten Modulmetadaten enthalten.
    PrivateData = @{

        PSData = @{

            # 'Tags' wurde auf das Modul angewendet und unterstützt die Modulermittlung in Onlinekatalogen.
            Tags         = @('php', 'version')

            # Eine URL zur Lizenz für dieses Modul.
            LicenseUri   = 'https://github.com/arueckauer/Php-VersionSwitcher/blob/master/LICENSE.txt'

            # Eine URL zur Hauptwebsite für dieses Projekt.
            ProjectUri   = 'https://github.com/arueckauer/Php-VersionSwitcher'

            # Eine URL zu einem Symbol, das das Modul darstellt.
            # IconUri = ''

            # 'ReleaseNotes' des Moduls
            ReleaseNotes = 'https://github.com/arueckauer/Php-VersionSwitcher/blob/master/CHANGELOG.md'

        }

    }

}

</code></pre>
<h2 id="giving-the-module-a-new-home">Giving the module a new home</h2>
<p>Since I am using a custom PowerShell profile and <a href="https://github.com/dahlbyk/posh-git">posh-git</a>, I do already have a <code>WindowsPowerShell</code> folder in my user&rsquo;s documents path (<code>C:\Users\&lt;Username&gt;\Documents\WindowsPowerShell</code>). If you&rsquo;re using a machine, where you don&rsquo;t have that folder, have a look at the <a href="https://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Core/Import-Module?view=powershell-6">Import-Module</a> might help you getting there.</p>
<p>I am moving the two created files <code>Php-VersionSwitcher.psm1</code> and <code>Php-VersionSwitcher.psd1</code> to a new home for my custom module: <code>C:\Users\Rueckauer\Documents\WindowsPowerShell\Modules\Php-VersionSwitcher\1.0.0</code>.</p>
<h2 id="import-module">Import-Module</h2>
<p>In my PowerShell profile (<code>C:\Users\Rueckauer\Documents\WindowsPowerShell\profile.ps1</code>) I add a line to import my new module.</p>
<pre><code class="language-powershell">Import-Module Php-VersionSwitcher
</code></pre>
<h2 id="test-it">Test it</h2>
<p>Now I power up a new PowerShell and try to access the <code>Php-VersionSwitcher</code> function.</p>
<p>Hm, I do get a warning. 🤔</p>
<blockquote>
<p>WARNUNG: Die Namen einiger importierter Befehle auf Modul &ldquo;Php-VersionSwitcher&rdquo; enthalten nicht genehmigte Verben, sodass deren Auffindbarkeit erschwert werden kann. Wenn Sie die Befehle mit nicht genehmigten Verben finden möchten, führen Sie den Import-Module-Befehl erneut mit dem Verbose-Parameter aus. Sie können durch Eingeben von &ldquo;Get-Verb&rdquo; eine Liste der genehmigten Verben anzeigen.</p>
</blockquote>
<p>Something is not right with the module name. I need to figure that out later. Let&rsquo;s see, if it works despite the warning.</p>
<p><img src="https://arueckauer.github.io/img/php-version-switcher-powershell-module/php-versionswitcher.png" alt="Execution of Php-VersionSwitcher"></p>
<p>Yes, neat! 💪🏻</p>
<p>Okay, that&rsquo;s it for today. Next time I will breath some life into that function.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://arueckauer.github.io/tags/100-days-of-code">100-days-of-code</a></span><span class="tag"><a href="https://arueckauer.github.io/tags/php">php</a></span><span class="tag"><a href="https://arueckauer.github.io/tags/powershell">powershell</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>1058 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2019-05-28 20:36 &#43;0200</p>
                <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg><a href="https://github.com/arueckauer/blog/commit/56e271ff3357e759c8b96bea933d6476fb439cdf" target="_blank" rel="noopener">56e271f</a> @ 2019-05-31</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="https://arueckauer.github.io/posts/2019/05/php-version-switcher-powershell-naming-convention/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Php Version Switcher: PowerShell Naming Convention</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="https://arueckauer.github.io/posts/2019/05/difference-of-squares/">
                                <span class="button__text">Difference of Squares</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
                <span><a href="https://arueckauer.github.io/">Andi Rückauer</a></span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span> <a href="https://arueckauer.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="https://arueckauer.github.io/bundle.min.648cbdb411bb57181906d73a5e1c9f26680cde5c03e04de5350e4d20c491ff3db990efb0d71e1fd5f57604f06c78379555c7f829c9bf6c2782acfd6471867611.js" integrity="sha512-ZIy9tBG7VxgZBtc6XhyfJmgM3lwD4E3lNQ5NIMSR/z25kO&#43;w1x4f1fV2BPBseDeVVcf4Kcm/bCeCrP1kcYZ2EQ=="></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-35992501-5', 'auto');
        ga('send', 'pageview');
    </script>


	
		<script src="https://unpkg.com/feather-icons"></script>
	


<script>
    feather.replace()
</script>

    </body>
</html>
